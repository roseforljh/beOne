import{a as e,j as t}from"./index-uVwVOvxz.js";import{r as i}from"./react-vendor-D3OtlHN5.js";import{A as s,m as l}from"./utils-vendor-C4paqCkD.js";function a({file:a,onClose:r}){const[c,n]=i.useState(""),[m,x]=i.useState(!1);if(!a)return null;const d=a.mimetype?.startsWith("image/"),o=a.mimetype?.startsWith("video/"),p=a.mimetype?.startsWith("audio/"),h=a.mimetype?.includes("pdf"),j=a.mimetype?.startsWith("text/")||a.mimetype?.includes("json")||a.mimetype?.includes("xml");i.useEffect(()=>{if(j&&a.id){x(!0);const t=e.getPreviewUrl(a.id);fetch(t).then(e=>{if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return e.text()}).then(e=>{n(e)}).catch(e=>{n(`åŠ è½½æ–‡æœ¬å†…å®¹å¤±è´¥: ${e.message}`)}).finally(()=>{x(!1)})}},[a.id,j]);const f=()=>{window.open(e.getDownloadUrl(a.id),"_blank")};return t.jsx(s,{children:t.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-2 md:p-4",onClick:r,children:t.jsxs(l.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-taiji-white rounded-xl md:rounded-2xl max-w-6xl w-full h-[95vh] md:h-[90vh] overflow-hidden flex flex-col",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"bg-taiji-black text-taiji-white px-3 md:px-6 py-3 md:py-4 flex items-center justify-between flex-shrink-0",children:[t.jsxs("div",{className:"flex-1 min-w-0 mr-2 md:mr-4",children:[t.jsx("h3",{className:"text-sm md:text-base font-medium truncate",children:a.original_name}),t.jsx("p",{className:"text-xs opacity-75",children:a.mimetype})]}),t.jsxs("div",{className:"flex gap-1 md:gap-2",children:[t.jsx("button",{onClick:f,className:"px-3 md:px-4 py-2 bg-taiji-white text-taiji-black rounded-lg hover:bg-taiji-gray-100 transition-colors text-xs md:text-sm font-medium",children:"ä¸‹è½½"}),t.jsx("button",{onClick:r,className:"px-3 md:px-4 py-2 bg-taiji-gray-700 text-taiji-white rounded-lg hover:bg-taiji-gray-600 transition-colors text-xs md:text-sm font-medium",children:"å…³é—­"})]})]}),t.jsxs("div",{className:"flex-1 overflow-auto bg-taiji-gray-100 flex items-center justify-center p-2 md:p-4",children:[d&&t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx("img",{src:e.getPreviewUrl(a.id),alt:a.original_name,className:"max-w-full max-h-full object-contain",style:{maxHeight:"calc(95vh - 120px)"},onError:e=>{e.target.onerror=null,e.target.parentElement.innerHTML=`\n                      <div class="text-center">\n                        <p class="text-6xl mb-4">ğŸ–¼ï¸</p>\n                        <p class="text-taiji-gray-600 mb-4">å›¾ç‰‡åŠ è½½å¤±è´¥</p>\n                        <p class="text-sm text-taiji-gray-500">æ–‡ä»¶ID: ${a.id}</p>\n                      </div>\n                    `}})}),o&&t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx("video",{controls:!0,className:"max-w-full max-h-full",style:{maxHeight:"calc(95vh - 120px)"},src:e.getPreviewUrl(a.id),children:"æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾"})}),p&&t.jsx("div",{className:"w-full max-w-md px-4",children:t.jsxs("div",{className:"bg-taiji-white rounded-lg p-4 md:p-6 shadow-lg",children:[t.jsxs("div",{className:"text-center mb-4",children:[t.jsx("p",{className:"text-5xl md:text-6xl mb-4",children:"ğŸµ"}),t.jsx("p",{className:"text-base md:text-lg font-medium text-taiji-black break-words",children:a.original_name})]}),t.jsx("audio",{controls:!0,className:"w-full",src:e.getPreviewUrl(a.id),children:"æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾"})]})}),h&&t.jsx("div",{className:"w-full h-full",children:t.jsx("embed",{src:e.getPreviewUrl(a.id),type:"application/pdf",className:"w-full h-full",style:{minHeight:"500px",maxHeight:"calc(95vh - 120px)"}})}),j&&t.jsx("div",{className:"w-full h-full flex items-center justify-center px-2 md:px-4",children:t.jsx("div",{className:"w-full max-w-4xl bg-taiji-white rounded-lg p-3 md:p-6 shadow-lg max-h-full overflow-auto",children:m?t.jsx("p",{className:"text-center text-taiji-gray-500",children:"åŠ è½½ä¸­..."}):t.jsx("pre",{className:"text-xs md:text-sm text-taiji-black whitespace-pre-wrap break-words font-mono",children:c})})}),!d&&!o&&!p&&!h&&!j&&t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-6xl mb-4",children:"ğŸ“„"}),t.jsx("p",{className:"text-taiji-gray-600 mb-4",children:"æ— æ³•é¢„è§ˆæ­¤æ–‡ä»¶ç±»å‹"}),t.jsx("button",{onClick:f,className:"btn-primary",children:"ä¸‹è½½æ–‡ä»¶"})]})]})]})})})}export{a as F};
